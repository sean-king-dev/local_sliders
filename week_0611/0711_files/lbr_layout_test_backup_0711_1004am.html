<script>

    const locations = [
        {
            id: '1',
            title: 'One',
            image: 'https://placehold.co/1920x1080?text=One',
            ctaLink: 'https://en.wikipedia.org/wiki/One'
        },
        {
            id: '2',
            title: 'Two',
            image: 'https://placehold.co/1920x1080?text=Two',
            ctaLink: 'https://en.wikipedia.org/wiki/Two'
        },
        {
            id: '3',
            title: 'Three',
            image: 'https://placehold.co/1920x1080?text=Three',
            ctaLink: 'https://en.wikipedia.org/wiki/Three'
        },
        {
            id: '4',
            title: 'Four',
            image: 'https://placehold.co/1920x1080?text=Four',
            ctaLink: 'https://en.wikipedia.org/wiki/Four'
        },
        {
            id: '5',
            title: 'Five',
            image: 'https://placehold.co/1920x1080?text=Five',
            ctaLink: 'https://en.wikipedia.org/wiki/Five'
        },
        {
            id: '6',
            title: 'Six',
            image: 'https://placehold.co/1920x1080?text=Six',
            ctaLink: 'https://en.wikipedia.org/wiki/Six'
        },
        {
            id: '7',
            title: 'Seven',
            image: 'https://placehold.co/1920x1080?text=Seven',
            ctaLink: 'https://en.wikipedia.org/wiki/Seven'
        },
        {
            id: '8',
            title: 'Eight',
            image: 'https://placehold.co/1920x1080?text=Eight',
            ctaLink: 'https://en.wikipedia.org/wiki/Eight'
        },
        {
            id: '9',
            title: 'Nine',
            image: 'https://placehold.co/1920x1080?text=Nine',
            ctaLink: 'https://en.wikipedia.org/wiki/Nine'
        },
        {
            id: '10',
            title: 'Ten',
            image: 'https://placehold.co/1920x1080?text=Ten',
            ctaLink: 'https://en.wikipedia.org/wiki/Ten'
        },
          {
            id: '11',
            title: 'Eleven',
            image: 'https://placehold.co/1920x1080?text=Eleven',
            ctaLink: 'https://en.wikipedia.org/wiki/Eleven'
        },
        {
            id: '12',
            title: 'Twelve',
            image: 'https://placehold.co/1920x1080?text=Twelve',
            ctaLink: 'https://en.wikipedia.org/wiki/Twelve'
        },
        {
            id: '13',
            title: 'Thirteen',
            image: 'https://placehold.co/1920x1080?text=Thirteen',
            ctaLink: 'https://en.wikipedia.org/wiki/Thirteen'
        },
        {
            id: '14',
            title: 'Fourteen',
            image: 'https://placehold.co/1920x1080?text=Fourteen',
            ctaLink: 'https://en.wikipedia.org/wiki/Fourteen'
        },
        {
            id: '15',
            title: 'Fifteen',
            image: 'https://placehold.co/1920x1080?text=Fifteen',
            ctaLink: 'https://en.wikipedia.org/wiki/Fifteen'
        },
        {
            id: '16',
            title: 'Sixteen',
            image: 'https://placehold.co/1920x1080?text=Sixteen',
            ctaLink: 'https://en.wikipedia.org/wiki/Sixteen'
        },
    ];
    
    
        
    window.addEventListener("DOMContentLoaded", function(){
    
    const mainSlide = document.querySelector(".main_slide_inner");
    const thumbSlide = document.querySelector(".thumb_slide_inner");
    const thumbSliderButton = document.querySelector(".thumb_slider_button");
    const thumbSlideItems = document.querySelectorAll(".thumb_slide_item");
    
    let currentSlideIndex = 0;
    let currentIndex = 0;
    let currentThumbIndex = 0;
    
    
    const modxMainCarouselData = document.querySelector(".main_carouseldata");
    // console.log(JSON.stringify(modxMainCarouselData));
    console.log(modxMainCarouselData);
    
    const modxThumbCarouselData = document.querySelector(".thumb_carouseldata");
    // console.log(JSON.stringify(modxThumbCarouselData));
    console.log(modxThumbCarouselData);
    
    const thumbMetaData = document.querySelectorAll(".main_fade_slide .hidden_thumb_slide");
    console.log(thumbMetaData);
    
    
    
    // get modx thumbnail data
    
    
    // main fade slider
    // locations.forEach((location, index) => {
    //     document.querySelectorAll(".main_fade_slide").forEach((location, index) => {
    //     const mainSlideItem = document.createElement("div");
    //     mainSlideItem.classList.add("main_slide_item");
    
    //     mainSlideItem.innerHTML = `
    //     <div class="location_item">
    //       <div class="main-image-slide" style="background-image: url('${location.image}')">
    //         <p class="h5 location-title">${location.title}</p>
    //         <a href="${location.ctaLink}" class="cta-link"><span>Go</span></a>
    //       </div>
    //       </div>
    //     `;
    
    //     mainSlide.appendChild(mainSlideItem);
        
        
    //   });
    
    // // get  main slider modx
    let mainSlideContainer = document.querySelector(".main_fade_slide");
    
    // create main slide div
    let mainImage = document.createElement("div");
    mainImage.className = "main_slide_item";
    
    // make first item in array visible
    mainSlideContainer.querySelector(".main_slide_item:first-child").classList.add("active");
    
    // attach slide item to wrapper
    mainSlideContainer.appendChild(mainImage);
    
    document.querySelectorAll('.main_fade_slide').forEach(function() {
        // dynamically pulls in image from class name via modx
        // ... your code for dynamically pulling in the image goes here
    });
    
    
    
    //   // thumbnail carousel
    //   let thumbSlideContainer = document.querySelector(".thumb_carousel");
    //    // create thumb slide inner carousel container div
    //    let thumbImageInner = document.createElement("div");
    //     thumbImageInner.setAttribute("class", "thumb_slide_inner");
    
    //     // attach thumb slide to thumb parent container
    //     thumbSlideContainer.appendChild(thumbImageInner);
    // //   locations.forEach((location, index) => {
    //     document.querySelectorAll('.hidden_thumb_slide').forEach(function() {
    
    //     // get source data to put into slide
    //     let thumb_image = element.querySelector(".thumb img").getAttribute("src");
    //     let thumb_title = element.querySelector(".title p.h4 img").getAttribute("title");
    //     let thumb_link = element.querySelector(".thumb_link").getAttribute('data-link');
    
    //     // const thumbSlideItem = document.createElement("div");
    //     // thumbSlideItem.classList.add("thumb_slide_item");
        
    //     thumbSlideItem.innerHTML = `
    //     <div class="thumb_location_item">
    //     <div class="map_pin show-pin">&#9906;</div>
    //       <div class="thumb-image-slide" style="background-image: url('${thumb_image}')">
    //         <p class="h5 thumb-location-title">${thumb_title}</p>
    //         <a href="${thumb_link}" class="thumb-cta-link show-go"><span class="go-button">Go</span><span class="go-arrow">&#8702;</span></a>
    //       </div>
    //       </div>
    //     `;
     
    //     thumbImageInner.appendChild(thumbSlideItem);
        
    //   });
    
    // Thumbnail carousel
    let thumbSlideContainer = document.querySelector(".thumb_carousel");
    
    // Create thumb slide inner carousel container div
    let thumbImageInner = document.querySelector(".thumb_slide_inner");
    
    // Attach thumb slide inner to thumb parent container
    thumbSlideContainer.appendChild(thumbImageInner);
    
    // Loop through each hidden thumb slide element
    document.querySelectorAll('.hidden_thumb_slide').forEach((element) => {
    
      // Create the thumbSlideItem div
      let thumbSlideItem = document.createElement("div");
      thumbSlideItem.classList.add("thumb_slide_item");
    
      // Get source data to put into slide
      let thumb_image = element.querySelector(".thumb img").getAttribute("src");
      let thumb_title = element.querySelector(".title p.h4").innerText; // Changed from getAttribute to innerText for the title
      let thumb_link = element.querySelector(".thumb_link").getAttribute('data-link');
    
      // Create and set the innerHTML of the thumbSlideItemInner with template literals
      let thumbSlideItemInner = document.createElement("div"); // Define thumbSlideItemInner
      thumbSlideItemInner.innerHTML = `
        <div class="thumb_location_item">
          <div class="map_pin show-pin">&#9906;</div>
          <div class="thumb-image-slide" style="background-image: url('${thumb_image}')">
            <p class="h5 thumb-location-title">${thumb_title}</p>
            <a href="${thumb_link}" class="thumb-cta-link show-go">
              <span class="go-button">Go</span>
              <span class="go-arrow">&#8702;</span>
            </a>
          </div>
        </div>
      `;
    
      // Append the thumbSlideItemInner to the thumbSlideItem
      thumbSlideItem.appendChild(thumbSlideItemInner);
    
      // Attach thumb slide item to thumb slide inner
      thumbImageInner.appendChild(thumbSlideItem);
    });
    
    
    // // create thumb slide inner carousel container div
    // // let thumbImageInner = document.createElement("div");
    // // thumbImageInner.setAttribute("class", "thumb_slide_inner");
    // const thumbImageInner = document.querySelector(".thumb_slide_inner");
    
    // // Loop through elements with class "hidden_thumb_slide"
    // let hiddenThumbSlides = document.querySelectorAll(".hidden_thumb_slide");
    //     hiddenThumbSlides.forEach(function (hiddenThumbSlide, index) {
    
    //         // Get source data for thumb image, title, and link
    //         let thumbImage = hiddenThumbSlide.querySelector(".thumb img").getAttribute("src");
    //         let thumbTitle = hiddenThumbSlide.querySelector(".title p.h4 img").getAttribute("title");
    //         let thumbLink = hiddenThumbSlide.querySelector(".thumb_link").getAttribute('data-link');
    
    //         // Create thumb item HTML component
    //         let showMainSlide = `
    //             <div class="thumb_slide_item" data-slideindex=${index}>
    //                 <div class="ThumbImgTop_Pointer thumbnail_show_pin"></div>
    //                 <div class="image-bg-div" style="background:url(${thumbImage});">
    //                     <p class="h4 main_title">${thumbTitle}</p>
    //                     <a href="${thumbLink}" class="ctalink go-button thumbnail_show_button" href="${thumbLink}"><span>Go</span><i class="fa fa-arrow-right"></i></a>
    //                 </div>
    //             </div>
    //         `;
    
    //         // Append dynamic HTML components to the inner slider carousel container
    //         thumbImageInner.innerHTML += showMainSlide;
    //     });
    
    
    
    
            function activateMainSlide(index) {
              const mainSlideItems = document.querySelectorAll(".main_slide_item");
              mainSlideItems.forEach((item) => item.classList.remove("active"));
              mainSlideItems[index].classList.add("active");
            }
      
      function activateThumbnailSlide(index) {
            const thumbSlideItems = document.querySelectorAll(".thumb_slide_item");
            thumbSlideItems.forEach((item) => item.classList.remove("active"));
            thumbSlideItems[index].classList.add("active");
    
            // Calculate the maximum scroll position to ensure the last items are fully visible
            const thumbSlideItemWidth = thumbSlideItems[0].offsetWidth;
            const thumbSliderButtonWidth = thumbSliderButton.offsetWidth;
            const totalWidth = thumbSlideItemWidth * locations.length;
            const maxScrollPosition = totalWidth - thumbSliderButtonWidth;
    
            // Calculate the scroll position for the current item
            let scrollPosition = thumbSlideItemWidth * index;
            const centerOffset = thumbSliderButtonWidth / 1.15;
    
            // Adjust scrollPosition if the current item is one of the last few items
            if (index >= locations.length - 1) {
                scrollPosition = maxScrollPosition;
            } else if (index > 0) {
                scrollPosition -= centerOffset;
            }
    
            // make sure the scrollPosition stays within bounds
            scrollPosition = Math.max(0, Math.min(maxScrollPosition, scrollPosition));
    
            thumbSlide.scrollLeft = scrollPosition;
        }
    
            function activateSlide(index) {
              activateMainSlide(index); // Apply active class to main slides
              activateThumbnailSlide(index); // Apply active class to thumbnail slides
            }
    
            function nextSlide() {
                currentIndex = (currentIndex + 1) % locations.length;
                activateSlide(currentIndex);
            }
    
            let slideInterval = setInterval(nextSlide, 2000);
    
            thumbSlide.addEventListener("mouseenter", function () {
            clearInterval(slideInterval);
        });
    
        thumbSlide.addEventListener("mouseleave", function () {
            slideInterval = setInterval(nextSlide, 2000);
        });
    
        activateSlide(currentIndex);
    
        // Add these variables to your existing code
        const prevButton = document.getElementById("slide-arrow-prev");
        const nextButton = document.getElementById("slide-arrow-next");
    
        // Add event listeners to the previous and next buttons
        prevButton.addEventListener("click", () => {
            currentIndex = (currentIndex - 1 + locations.length) % locations.length;
            activateSlide(currentIndex);
        });
    
        nextButton.addEventListener("click", () => {
            currentIndex = (currentIndex + 1) % locations.length;
            activateSlide(currentIndex);
        });
        
    });
    </script>